String.prototype.replaceAll=function(B,A,C){if(!RegExp.prototype.isPrototypeOf(B)){return this.replace(new RegExp(B,(C?"gi":"g")),A)}else{return this.replace(B,A)}};$.fn.extend({popupTip:function(F,E,D,A){var B='<div id="processTip">';B+='<div class="pro_wrap">';B+='<div class="text" style="text-align:left;font-size:18px;line-height:20px;height:100px;padding-top:20px;padding-right:10px;"></div>';B+="</div>";B+="</div>";if($("#processTip").size()==0){$("body").append(B)}var C=$("#processTip").find(".pro_wrap");if(E=="success"){C.find(".text").text(F);if(D==true){C.attr("class","pro_wrap pro_success").fadeIn(5000,function(){window.location.reload()})}else{if(A!=undefined){C.attr("class","pro_wrap pro_success").fadeIn(5000,function(){window.location=A})}else{C.attr("class","pro_wrap pro_success").fadeIn().delay(1000).fadeOut()}}}else{if(E=="fail"){C.find(".text").text(F);if(D==true){C.attr("class","pro_wrap pro_warning").fadeIn(5000,function(){window.location.reload()})}else{if(A!=undefined){C.attr("class","pro_wrap pro_warning").fadeIn(5000,function(){window.location=A})}else{C.attr("class","pro_wrap pro_warning").fadeIn().delay(1000).fadeOut()}}}else{if(E=="loading"){C.find(".text").text(F);C.attr("class","pro_wrap pro_loading").fadeIn()}}}},alert:function(G,K,I,D,F,J){var H=this;var B=200;if(F){B=F}if($(H).hasClass("lead-message")!=""){var L=dialog({title:G,content:K,width:B,okValue:"确 定",ok:function(){if(D){(D)()}},cancelDisplay:false,cancel:function(){if(J){(J)()}}});L.showModal()}return;if($(".message-mask-resize").size()==0){$("body").append('<div class="message-mask-resize" style="width:100%;"></div>')}var E="";if(D){E="("+D+")()";E=E.replaceAll('"',"'")}var B=$(window).width()/2-100+$(document).scrollLeft();var C=$(window).height()/2-120+$(document).scrollTop();var A="";A+='<div class="lead-message" style="left: '+(B)+"px; top: "+(C)+'px;position:absolute;background-color:#dce3ef;border:1px solid #8895f8;width:300px;">';A+='<div style="padding:2px;background-color:#dce3ef;text-align:left;">'+G;A+='   <a href="javascript:void(0);" style="text-decoration:none;color:black;" onclick="$(this).parent().parent().remove();$(\'.message-mask-side\').remove();"><span style="float:right;padding-right:5px;">[X]</span></a>';A+="</div>";A+='<div style="padding:5px;margin:5px;background-color:#fff;border:1px solid #8895f8;text-align:left;">'+K;A+='   <div style="padding:20px 10px 10px 10px;text-align:center;">';A+='   <a href="javascript:void(0);" style="text-decoration:none;color:black;" onclick="$(this).parent().parent().parent().remove();$(\'.message-mask-side\').remove();'+E+'"><span style="padding:3px 23px;border:1px solid #d3d3d3;background-color:#e9e9e9;">确定</span></a>';A+="   </div>";A+="</div>";A+="</div>";if($(H).hasClass("lead-message")!=""){$("body").append('<div class="message-mask-side" style="opacity:0.4;position:absolute;top:0px;left:0px;width:'+($("body").outerWidth(true)*1.5)+"px;height:"+$(document).height()+'px;background-color:#cccccc"></div>');switch(I){case"info":$("body").append(A);break;case"error":$("body").append(A);break}$(".message-mask-resize").resize(function(){$(".message-mask-side").width($("body").outerWidth(true));$(".message-mask-side").height($(document).height())})}},confirm:function(G,I,E){var H=this;if($(H).hasClass("lead-message")!=""){var A=dialog({title:G,content:I,width:200,okValue:"确 定",ok:function(){if(E){(E)(true)}},cancelValue:"取消",cancel:function(){}});A.showModal()}return;if($(".message-mask-resize").size()==0){$("body").append('<div class="message-mask-resize" style="width:100%;"></div>')}var F="",J="";if(E){F="("+E+")(true)";J="("+E+")(false)";F=F.replaceAll('"',"'");J=J.replaceAll('"',"'")}var B=$(window).width()/2-100+$(document).scrollLeft();var D=$(window).height()/2-120+$(document).scrollTop();var C="";C+='<div class="lead-message" style="left: '+(B)+"px; top: "+(D)+'px;position:absolute;background-color:#dce3ef;border:1px solid #8895f8;width:300px;">';C+='<div style="padding:2px;background-color:#dce3ef;text-align:left;">'+G;C+='   <a href="javascript:void(0);" style="text-decoration:none;color:black;" onclick="$(this).parent().parent().remove();$(\'.message-mask-side\').remove();"><span style="float:right;padding-right:5px;">[X]</span></a>';C+="</div>";C+='<div style="padding:5px;margin:5px;background-color:#fff;border:1px solid #8895f8;text-align:left;">'+I;C+='   <div style="padding:20px 10px 10px 10px;text-align:center;">';C+='   <a href="javascript:void(0);" style="text-decoration:none;color:black;" onclick="$(this).parent().parent().parent().remove();$(\'.message-mask-side\').remove();'+F+'"><span style="padding:3px 23px;border:1px solid #d3d3d3;background-color:#e9e9e9;">确定</span></a>';C+='   <a href="javascript:void(0);" style="text-decoration:none;color:black;" onclick="$(this).parent().parent().parent().remove();$(\'.message-mask-side\').remove();'+J+'"><span style="padding:3px 23px;border:1px solid #d3d3d3;background-color:#e9e9e9;">取消</span></a>';C+="   </div>";C+="</div>";C+="</div>";if($(H).hasClass("lead-message")!=""){$("body").append('<div class="message-mask-side" style="opacity:0.4;position:absolute;top:0px;left:0px;width:'+$("body").outerWidth(true)+"px;height:"+$(document).height()+'px;background-color:#cccccc"></div>');$("body").append(C);$(".message-mask-resize").resize(function(){$(".message-mask-side").width($("body").outerWidth(true));$(".message-mask-side").height($(document).height())})}},datalist:function(params,paramdata){var self=this;if($(self).next().hasClass("lead-pager")==""){var shtml="";shtml+='<span class="lead-pagebar"></span>';shtml+='<span class="lead-pagedes"></span>';shtml+='<span class="lead-pagego"></span>';shtml+='<input class="lead-pageInfo" type="hidden" value=""/>';shtml+='<input class="lead-pageFunc" type="hidden" value=""/>';shtml='<div class="lead-pager">'+shtml+"</div>";$(self).after(shtml)}if($(self).hasClass("lead-list")!=""){if(paramdata==null){switch(params){case"getPager":var hidPager=$(self).next().find(".lead-pageInfo");var pagerInfo={};if(hidPager.val()!=""){pagerInfo=jQuery.parseJSON(hidPager.val())}pagerInfo.pageIndex=1;hidPager.val(JSON.stringify(pagerInfo));return $(self).next();break;case"clear":$(self).find(".lead-dataitem").remove();break;default:var hidPager=$(self).next().find(".lead-pageInfo");var pagerInfo={};if(hidPager.val()!=""){pagerInfo=jQuery.parseJSON(hidPager.val())}if(params.pageSize){pagerInfo.pageSize=params.pageSize}if(params.pagination){pagerInfo.pagination=params.pagination}hidPager.val(JSON.stringify(pagerInfo));return self;break}}else{switch(params){case"loadData":var selfitem=null;if($(self).find(".lead-templateitem").size()>0){selfitem=$(self).find(".lead-templateitem").eq(0);$(self).find(".lead-item").remove()}else{selfitem=$(self).find(".lead-item").eq(0).removeClass("lead-item").addClass(" lead-templateitem")}$.each(paramdata.rows,function(index,item){var strEven="";if(index%2==1){strEven=" lead-even"}var cloneitem=selfitem.clone(false).removeClass("lead-templateitem").addClass(" lead-item lead-dataitem"+strEven);$(cloneitem).find("[data-options]").each(function(){var options=eval("({"+$(this).attr("data-options")+"})");if(item[options.field]||item[options.field]=="0"){switch($(this).attr("type")){case"text":$(this).val(""+item[options.field]);break;default:$(this).html(""+item[options.field]);break}}if(item[options.hideFieldOnTrue]==true){$(this).hide()}if(item[options.hideFieldOnFalse]==false){$(this).hide()}});$(self).append(cloneitem)});var hidPager=$(self).next().find(".lead-pageInfo");var pagerInfo={};if(hidPager.val()!=""){pagerInfo=jQuery.parseJSON(hidPager.val())}if(!pagerInfo.pageIndex){pagerInfo.pageIndex=1}if(!pagerInfo.pageSize){pagerInfo.pageSize=10}pagerInfo.total=paramdata.total;hidPager.val(JSON.stringify(pagerInfo));$(self).find(".lead-emptyitem").remove();if(paramdata.rows.length==0){$(self).next().find(".lead-pagebar").html("");$(self).next().find(".lead-pagedes").html("");$(self).next().find(".lead-pagego").html("");if(self[0].tagName.toLowerCase()=="table"){$(self).append('<tr class="lead-emptyitem"><td colspan="200" style="text-align:center;">无数据</td></tr>')}else{$(self).append('<div class="lead-emptyitem" style="text-align:center;">无数据</div>')}}if(pagerInfo.pagination==true){if(pagerInfo.pageIndex==1){var totalPage=Math.ceil(pagerInfo.total/pagerInfo.pageSize);var shtml="";for(var i=1;i<=totalPage;i++){var selectPager="";if(i==pagerInfo.pageIndex){selectPager='class="selectpager"'}shtml+='<a href="#" '+selectPager+' onclick="$.LeadGrid.selectPage(this, '+i+')">'+i+"</a>";if(i>=$.LeadGrid.pageNumber){break}}if($.LeadGrid.pageNumber<totalPage){shtml+='<span>...</span><a href="#" onclick="$.LeadGrid.selectPage(this, '+totalPage+')">'+totalPage+"</a>"}if(paramdata.rows.length>0){$(self).next().find(".lead-pagego").html('转到<input type="text" class="lead-pagegoto" onkeypress="$.LeadGrid.gotoPage(this,event)" />');var preClass="",nextClass="";if(pagerInfo.pageIndex==1){preClass='class="unablepager"'}if(pagerInfo.pageIndex==totalPage){nextClass='class="unablepager"'}shtml='<a style="margin-right:10px;" '+preClass+' href="#" onclick="$.LeadGrid.selectPage(this, -2)">上一页</a>'+shtml+'<a style="margin-left:10px;" '+nextClass+' href="#" onclick="$.LeadGrid.selectPage(this, -3)">下一页</a>';$(self).next().find(".lead-pagebar").html(shtml);var strPagedes="当前页 ";if(pagerInfo.total>0){strPagedes+="1-";if(pagerInfo.total>=pagerInfo.pageSize){strPagedes+=pagerInfo.pageIndex*pagerInfo.pageSize}else{strPagedes+=pagerInfo.total}}else{strPagedes+="0"}strPagedes+="条";strPagedes+=" 共"+pagerInfo.total+"条";$(self).next().find(".lead-pagedes").html(strPagedes)}}else{var total=pagerInfo.total;var pageIndex=pagerInfo.pageIndex;var pageSize=pagerInfo.pageSize;var totalPage=Math.ceil(total/pageSize);var si=1,ei=totalPage;if(pageIndex<$.LeadGrid.pageNumber){if(totalPage>$.LeadGrid.pageNumber){ei=$.LeadGrid.pageNumber}}else{if(pageIndex>totalPage-$.LeadGrid.pageNumber+1){si=totalPage-$.LeadGrid.pageNumber+1;ei=totalPage}else{if(pageIndex>=$.LeadGrid.pageNumber){var m=Math.floor($.LeadGrid.pageNumber/2);si=pageIndex-m;if(totalPage>pageIndex+m){ei=pageIndex+m}}}}var shtml="";if(si>1){shtml+='<a href="#" onclick="$.LeadGrid.selectPage(this, 1)">1</a>...'}for(var i=si;i<=ei;i++){var selectPager="";if(i==pageIndex){selectPager='class="selectpager"'}shtml+='<a href="#" '+selectPager+' onclick="$.LeadGrid.selectPage(this, '+i+')">'+i+"</a>"}if(ei<totalPage){shtml+='...<a href="#" onclick="$.LeadGrid.selectPage(this, '+totalPage+')">'+totalPage+"</a>"}var preClass="",nextClass="";if(pageIndex==1){preClass='class="unablepager"'}if(pageIndex==totalPage){nextClass='class="unablepager"'}shtml='<a style="margin-right:10px;" '+preClass+' href="#" onclick="$.LeadGrid.selectPage(this, -2)">上一页</a>'+shtml+'<a style="margin-left:10px;" '+nextClass+' href="#" onclick="$.LeadGrid.selectPage(this, -3)">下一页</a>';var begPagerecord=(pageIndex-1)*pagerInfo.pageSize+1;var endPagerecord=pageIndex*pagerInfo.pageSize;var strPagedes="当前页 "+begPagerecord+"-";if(pagerInfo.total>=endPagerecord){strPagedes+=endPagerecord}else{strPagedes+=pagerInfo.total}strPagedes+="条";strPagedes+=" 共"+pagerInfo.total+"条";$(self).next().find(".lead-pagebar").html(shtml);$(self).next().find(".lead-pagedes").html(strPagedes)}}$(self).find(".chkAll").bind("click",function(event){var checked=$(this).is(":checked");$(self).find(".lead-dataitem .chk").each(function(index,item){$(this).prop("checked",checked)});event.stopPropagation()});$(self).find(".chkAll").parent().bind("click",function(){var chkObject=$(this).find(".chkAll");var checked=!chkObject.is(":checked");chkObject.prop("checked",checked);$(self).find(".lead-dataitem .chk").each(function(index,item){$(item).prop("checked",checked)})});$(self).find(".chk").each(function(index,item){$(item).bind("click",function(event){event.stopPropagation()})});$(self).find("td").each(function(index,item){if($(item).find(".chk").length>0){$(item).bind("click",function(event){var chkObject=$(item).parent().find(".chk");chkObject.prop("checked",!chkObject.is(":checked"))})}});break;case"setPager":var hidPager=$(self).next().find(".lead-pageInfo");var pagerInfo={};if(hidPager.val()!=""){pagerInfo=jQuery.parseJSON(hidPager.val())}if(paramdata){if(paramdata.pageIndex>0){pagerInfo.pageIndex=paramdata.pageIndex}else{pagerInfo.pageIndex=1}pagerInfo.total=paramdata.total}hidPager.val(JSON.stringify(pagerInfo));break}}}},form:function(E,A){var B=this;if($(B).hasClass("lead-form")!=""){if(A&&E=="load"){var C=this.find("input[type=text],input[type=number],input[type=password],input[type=hidden],textarea,select");C.each(function(){var F=$(this);F.val(A[F.attr("name")])});var D=JSON.stringify(A).replace(new RegExp("{|\"|'|}","g"),"").split(",");var C=this.find("input[type=radio]");C.each(function(){var F=$(this);$.each(D,function(H,G){kv=G.split(":");if(kv[0]==F.attr("name")&&kv[1]==F.val()){F.prop("checked","checked")}})});C=this.find("input[type=checkbox]");C.each(function(){var F=$(this);$.each(D,function(H,G){kv=G.split(":");if(kv[0]==F.attr("name")&&(kv[1]+",").indexOf(F.val()+",")!=-1){F.prop("checked","checked")}})});var C=this.find("span,div");C.each(function(){var F=$(this);F.text(A[F.attr("name")])})}}},paginating:function(params){var self=this;if($(self).hasClass("lead-pager")!=""){var hidPager=$(self).find(".lead-pageInfo");var pagerInfo={};if(hidPager.val()!=""){pagerInfo=jQuery.parseJSON(hidPager.val())}var hidFunc=$(self).find(".lead-pageFunc");var pagerFunc=eval("({"+hidFunc.val()+"})");if(params.onSelectPage){pagerFunc.onSelectPage=params.onSelectPage}hidFunc.val("onSelectPage:"+pagerFunc.onSelectPage);hidPager.val(JSON.stringify(pagerInfo))}}});(function($){$.extend({ymessager:$('<div class="lead-message"></div>')});$.LeadGrid={data:null,pageNumber:5,selectPage:function(o,n){if($(o).hasClass("unablepager")){return}var hidPager=$(o).parent().parent().find(".lead-pageInfo");var pagerInfo=jQuery.parseJSON(hidPager.val());var total=pagerInfo.total;var pageIndex=pagerInfo.pageIndex;var pageSize=pagerInfo.pageSize;var totalPage=Math.ceil(total/pageSize);var hidFunc=$(o).parent().parent().find(".lead-pageFunc");var pagerFunc=eval("({"+hidFunc.val()+"})");switch(n){case -1:pageIndex=1;break;case -2:if(pageIndex>1){pageIndex=pageIndex-1}break;case -3:if(pageIndex<totalPage){pageIndex=pageIndex+1}break;case -4:pageIndex=totalPage;break;default:pageIndex=n;break}var si=1,ei=totalPage;if(pageIndex<this.pageNumber){if(totalPage>this.pageNumber){ei=this.pageNumber}}else{if(pageIndex>totalPage-this.pageNumber+1){si=totalPage-this.pageNumber+1;ei=totalPage}else{if(pageIndex>=this.pageNumber){var m=Math.floor(this.pageNumber/2);si=pageIndex-m;if(totalPage>pageIndex+m){ei=pageIndex+m}}}}var shtml="";if(si>1){shtml+='<a href="#" onclick="$.LeadGrid.selectPage(this, 1)">1</a>...'}for(var i=si;i<=ei;i++){var selectPager="";if(i==pageIndex){selectPager='class="selectpager"'}shtml+='<a href="#" '+selectPager+' onclick="$.LeadGrid.selectPage(this, '+i+')">'+i+"</a>"}if(ei<totalPage){shtml+='...<a href="#" onclick="$.LeadGrid.selectPage(this, '+totalPage+')">'+totalPage+"</a>"}var preClass="",nextClass="";if(pageIndex==1){preClass='class="unablepager"'}if(pageIndex==totalPage){nextClass='class="unablepager"'}shtml='<a style="margin-right:10px;" '+preClass+' href="#" onclick="$.LeadGrid.selectPage(this, -2)">上一页</a>'+shtml+'<a style="margin-left:10px;" '+nextClass+' href="#" onclick="$.LeadGrid.selectPage(this, -3)">下一页</a>';var begPagerecord=(pageIndex-1)*pagerInfo.pageSize+1;var endPagerecord=pageIndex*pagerInfo.pageSize;var strPagedes="当前页 "+begPagerecord+"-";if(pagerInfo.total>=endPagerecord){strPagedes+=endPagerecord}else{strPagedes+=pagerInfo.total}strPagedes+="条";strPagedes+=" 共"+pagerInfo.total+"条";$(o).parent().html(shtml).next().html(strPagedes);pagerInfo.pageIndex=pageIndex;hidPager.val(JSON.stringify(pagerInfo));eval("("+pagerFunc.onSelectPage+")("+pageIndex+","+pageSize+")")},gotoPage:function(o,e){if(e.keyCode==13){var hidPager=$(o).parents(".lead-pager").find(".lead-pageInfo");var pagerInfo=jQuery.parseJSON(hidPager.val());var totalPage=Math.ceil(pagerInfo.total/pagerInfo.pageSize);var n=eval($(o).val());if(n>totalPage||n<0){return}if(!isNaN($(o).val())){$.LeadGrid.selectPage($(o).parents(".lead-pager").find(".lead-pagebar a").eq(1),n)}else{$(o).val("")}}}}})(jQuery);(function(H,E,K){var I=H([]),A=H.resize=H.extend(H.resize,{}),F,D="setTimeout",C="resize",L=C+"-special-event",G="delay",J="throttleWindow";A[G]=250;A[J]=true;H.event.special[C]={setup:function(){if(!A[J]&&this[D]){return false}var M=H(this);I=I.add(M);H.data(this,L,{w:M.width(),h:M.height()});if(I.length===1){B()}},teardown:function(){if(!A[J]&&this[D]){return false}var M=H(this);I=I.not(M);M.removeData(L);if(!I.length){clearTimeout(F)}},add:function(N){if(!A[J]&&this[D]){return false}var M;function O(Q,R,S){var T=H(this),P=H.data(this,L);P.w=R!==K?R:T.width();P.h=S!==K?S:T.height();M.apply(this,arguments)}if(H.isFunction(N)){M=N;return O}else{M=N.handler;N.handler=O}}};function B(){F=E[D](function(){I.each(function(){var M=H(this),P=M.width(),O=M.height(),N=H.data(this,L);if(P!==N.w||O!==N.h){M.trigger(C,[N.w=P,N.h=O])}});B()},A[G])}})(jQuery,this);